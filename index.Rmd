---
title: "Disability discussion in parliament"
author: "Evan Odell"
date:
output:
  html_document:
    css: style.css
    keep_md: true
bibliography: references.bib
runtime: shiny
---

#### [Frequency Analysis](#freq)
##### [Frequency Chart](#freq_chart)
#### [Sentiment Analysis](#senti)
##### [Sentiment Chart](#senti_chart)

<!-- TO Do
1. Write discussion

2. Link to GIT repository

3. Upload Dataset

5. Link to Dataset
-->

# Disability discussion in parliament
How do politicians discuss disability issues? Has this changed over time? Are there any relationships between how disability issues are debated in Parliament and the policy decisions made by governments? In an attempt to answer these questions I downloaded everything that has ever been said in the House of Commons from 1936 to the present day.

<!-- Do frequency with ability to split by party -->

# Frequency of mentions of disability-relevant phrases
<a name="freq"></a>
I grouped 23 different disability relevant phrases into 15 groups. I selected phrases that are likely to be only used in relation to disability issues. This means that words such as 'blind' or 'deaf' cannot be used, as they are frequently used in non-disability discussion; e.g. 'the member opposite is deaf to the concerns of ordinary people'. See the complete list of phrases and their groupings [below](#word_list)

The number of uses of each group of phrases were counted for each day of debate in parliament, and averaged over a rolling calendar year. Note that the scale on the chart is a logarithmic scale, which means that each tick mark on the scale is the previous tick mark multiplied by two. This is so that changes in the frequency of relatively uncommon words is easy to see.

<!--Data import and custom functions -->

```{r setup, include=FALSE}

library(shiny)
library(shinyjs)
library(ggplot2)
library(scales)
library(grid)

disability_phrase_groups <- readRDS("./data/disability_phrase_groups.rds")

senti_combined <- readRDS("./data/senti_combined.rds")

all_average <- readRDS("./data/all_average.rds")

government_average <- readRDS("./data/government_average.rds")

party_average <- readRDS("./data/party_average.rds")


base_breaks <- function(n = 10){
  function(x) {
    axisTicks(log10(range(x, na.rm = TRUE)), log = TRUE, n = n)
  }
}

fmt_dcimals <- function(decimals=0){
  function(x) as.character(round(x,decimals))
}

```


<!--Colours for charts -->
```{r, include=FALSE}

line_colours <- c("Disabled Person"	=	"#006109",
                  "Disabled Men"	=	"#8a2093",
                  "Disabled Women"	=	"#00d38d",
                  "Disabled Children"	=	"#ff50a0",
                  "Disability Other"	=	"#5b5700",
                  "People With Disability"	=	"#7f8cff",
                  "Children With Disability"	=	"#fa7422",
                  "Any With Disability"	=	"#134eae",
                  "Independent Living"	=	"#d70039",
                  "Wheelchair"	=	"#97bcff",
                  "Paralympic"	=	"#8a3a1b",
                  "Spastic"	=	"#936996",
                  "Sub-Normal"	=	"#ff9176",
                  "Amputee"	=	"#9b2535",
                  "Retard"	=	"#ff7798")

line_styles <- c("Disabled Person"	=	"solid",
                 "Disabled Men"	=	"solid",
                 "Disabled Women"	=	"solid",
                 "Disabled Children"	=	"solid",
                 "Disability Other"	=	"longdash",
                 "People With Disability"	=	"longdash",
                 "Children With Disability"	=	"longdash",
                 "Any With Disability"	=	"longdash",
                 "Independent Living"	=	"twodash",
                 "Wheelchair"	=	"twodash",
                 "Paralympic"	=	"twodash",
                 "Spastic"	=	"dotdash",
                 "Sub-Normal"	=	"dotdash",
                 "Amputee"	=	"dotdash",
                 "Retard"	=	"dotdash")

debate_line <- c("All Debate" = "solid",
                "Disability" = "dotted")

senti_colour <- c("All Debate" = "#006332",
                  "Disability" = "#250858")

govt_line <- c("Government" = "solid",
               "Opposition" = "dotted")

govt_colour <- c("Government" = "#006332",
               "Opposition" = "#250858")

govt_type_line <- c("All Debate.Government" = "dotted",
                    "All Debate.Opposition" = "dotted",
                    "Disability.Government" = "solid",
                    "Disability.Opposition" = "solid")

gov_type_colour <- c("All Debate.Government" = "#8975ca",
                    "All Debate.Opposition" = "#71a659",
                    "Disability.Government" = "#cb5582",
                    "Disability.Opposition" = "#c5783e")

party_colour <- c("Liberal Democrat" = "#FDBB30",
                  "Conservative" = "#0087DC",
                  "Labour" = "#DC241f",
                  "Other" = "#2b2b2b")

party_type_colour <- c("All Debate.Conservative" = "#0087DC",
                       "Disability.Conservative" = "#a1dbff",
                       "All Debate.Labour" = "#DC241f",
                       "Disability.Labour" = "#e96461",
                       "All Debate.Liberal Democrat" = "#FDBB30",
                       "Disability.Liberal Democrat" = "#fedb91",
                       "All Debate.Other" = "#2b2b2b",
                       "Disability.Other" = "#bebebe")

party_type_line <- c("All Debate.Conservative" = "dotted",
                       "Disability.Conservative" = "solid",
                       "All Debate.Labour" = "dotted",
                       "Disability.Labour" = "solid",
                       "All Debate.Liberal Democrat" = "dotted",
                       "Disability.Liberal Democrat" = "solid",
                       "All Debate.Other" = "dotted",
                       "Disability.Other" = "solid")



```



### Frequency Chart
<a name="freq_chart"></a>
```{r, echo=FALSE}


shinyApp(
  
ui = fluidPage(
    column(width=9,
          
               h4("Disability Discussion Frequency Chart"),
               plotOutput("hansardplot")
           
    ),
    column(width=3,
          
               
               checkboxGroupInput("category_input",
                                  "Words and Phrases",
                                  c("Person/People With Disability" = "People With Disability",
                                    "Disabled Person/People"="Disabled Person", 
                                    "Disabled Men",
                                    "Disabled Women",          
                                    "Disabled Children",
                                    "Disability Other",
                                    "Children With Disability",
                                    "Any With Disability",
                                    "Independent Living",
                                    "Wheelchair",
                                    "Paralympic",
                                    "Spastic",
                                    "Sub-Normal",
                                    "Amputee",
                                    "Retard"),
                                  selected =c("Disabled Person","People With Disability")),
         
               sliderInput("year", "Year", 1936, 2016, value = c(1936, 2016), sep="")
           )
),


server = function(input, output, session) {
  
  
  getDataSet <- reactive({
    
    all_data <- disability_phrase_groups[disability_phrase_groups$Term %in% input$category_input
                                         & disability_phrase_groups$Year >= input$year[1]
                                         & disability_phrase_groups$Year <= input$year[2],]
  })
  
  
  output$hansardplot<-renderPlot({
    
    dataSet <- getDataSet()
    
    p3 <- ggplot(dataSet, aes(x=Date, group = Term, col = Term))
    p3 + geom_smooth(aes(y=value, linetype = Term, col=Term), size=1.5, formula=y ~ log(x), se=FALSE) +
      coord_cartesian(xlim = c(as.Date(min(dataSet$Date)), as.Date(max(dataSet$Date)))) + 
      scale_linetype_manual(values=line_styles) +
      scale_color_manual(values=line_colours) + 
      scale_x_date(date_breaks = "5 year",date_labels = "%Y") +
      #theme_bw() +
      scale_y_continuous(trans=log_trans(5),
                         breaks = base_breaks(),
                         name="Average Mentions per Day (Logarithmic Scale)",
                         labels = fmt_dcimals(3)) + 
      theme(axis.text.x = element_text(angle = 30, hjust = 1),
            text = element_text(size=14),
            legend.position="bottom", legend.background = element_rect()) 
    
  })
  
  
},
options = list(height = 600)
)
```

There are several patterns in the data that I would like to draw your attention to. The first is a very clear rise in the use of 'people with a disability' and similar phrases, instead of 'disabled people'. The popularity of 'person-first' language clearly extends to parliamentarians. 'Person-first' language is not without controversy, as this comment from disability campaigner Clenton Farquharson points out:

<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">The Social Model of Disability says society disables us, not our bodies. So putting ‘disabled’ first before ‘people’ highlights this <a href="https://twitter.com/hashtag/UKDHM?src=hash">#UKDHM</a></p>&mdash; C. Farquharson MBE (@clentonF) <a href="https://twitter.com/clentonF/status/803301978633859073">November 28, 2016</a></blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

Another notable trend is the increase in the use of 'amputee' in the years following armed conflicts. This is unsurprising, given the high profile of injured soldiers and the often traumatic nature of limb loss in armed conflict, but they make up a very small proportion of amputatees in the UK. Between October 2001 and March 2015 [234 UK service personnel had a limb amputated](https://www.gov.uk/government/uploads/system/uploads/attachment_data/file/449400/AnnexA_20150730_DAY-RELEASE_Quarterly_Afghanistan_Iraq_Amputation_Statistics.pdf), while according to Diabetes UK there are [135 amputations a week in England alone](https://www.diabetes.org.uk/about_us/news/more-than-135-diabetes-amputations-every-week/) as a result of diabetes complications. Naseer Ahmad, G Neil Thomas, Paramjit Gill, Colin Chan, and Francesco Torella [-@ahmad2014] found a [rate of 26.3 amputations per 100,000 people aged 50–84 years over a six year period in England](http://journals.sagepub.com/doi/10.1177/0141076814557301).

There are also very clear and obvious spikes in the use of 'paralympics' every four years. The reasons for this, I suppose, are obvious.


# Sentiment Analysis
<a name="senti"></a>
In addition to the frequency of different words used in the Hansard, I wanted to see if there are any changes in the sentiment of disability discussion. See [below](#senti_exp) for detailed information on how this chart was created.

You can toggle between three different sentiment analysis chart styles. The default chart is a line chart with a smoothed line of the average sentiment score trend. The second is a bar chart showing the average sentiment score each calendar year, and the third is a box plot showing the distribution of sentiment scores in each year.

The red 'All Debate' group is the sentiment score for a random sample of 1% of all debate in Parliament, and the purle 'Disability' group is the sentiment score for all debates that involve any of the disability-relevant terms and phrases.

The sentiment of all debates was, throughout the 1930s and 1940s, predominantly negative, on average. 1983 was the last year that disability debate was, on aggregate, negative, and 1994 was the first year where the sentiment in debate on disability issues was more positive than the average sentiment of parliamentary debate, and disability sentiment was also more positive than average every year from 1997 to 2010. Since 2011 disability sentiment has been less positive than overall debate sentiment, but the degree of positivity has increased year on year since 2013.

## Sentiment Charts

I have three created three sets of interactive charts. The [first set](#all_v_dis) compares all debate to debate on disability. The [second](#gov_dis) compares the government to the opposition, and the [third](#party_dis) compares different political parties. You can select from different sentiment libraries (the differences between them are explained [below](#senti_exp)), highlight only disability debate and focus in on particular years.

### All Debate vs Disability
<a name="senti_chart"></a>
<a name="all_v_dis"></a>

```{r, echo=FALSE}

shinyApp(

ui <- fluidPage(
  fluidRow(
                         conditionalPanel(
                           condition = "input.toggle % 3 == 0",
                           h5("Sentiment Line Chart"),
                           plotOutput("sentiplot")
                           ),
                         conditionalPanel(
                           condition = "input.toggle % 3 == 2",
                           h5("Sentiment Box Chart"),
                           plotOutput("sentibox")
                           ),
                         conditionalPanel(
                           condition = "input.toggle % 3 == 1",
                           h5("Sentiment Bar Chart"),
                           plotOutput("sentibar")
                         )
         
              ),
       fluidRow(
         column(width = 4,

                       checkboxGroupInput(
                         "debate_type", 
                         "Debate Type to Show",
                         choices=c("All Debate", "Disability"),
                         selected =c("All Debate", "Disability")
                       )
         ),
         column(width = 4,
                     radioButtons(
                       inputId="senti_options",
                       label="Select Sentiment Library:",
                       choices=c(
                         "Sentiword"="sentiword_sentiment",
                         "AFINN"="afinn_sentiment",
                         "Bing"="bing_sentiment",
                         "NRC"="nrc_sentiment",
                         "Hu Liu"="hu_sentiment"
                       ),
                       selected="sentiword_sentiment")
                ),column(width = 4,
                     
                       sliderInput("senti_year", "Year", 1936, 2016,
                                   value = c(1936, 2016), sep=""),
                       actionButton("toggle", "Switch Chart Type")
             
                        )
            )

), 

server <- function(input, output, session) {
  
  sentiDataSet <- reactive({
            
            senti_data <- senti_combined[senti_combined$year >= input$senti_year[1] 
                                         & senti_combined$year <= input$senti_year[2]
                                         & senti_combined$senti_type == input$senti_options
                                         & senti_combined$debate_type %in% input$debate_type,]
        
    })

 sentiDataBar <- reactive({
    
      senti_data <- all_average[all_average$year >= input$senti_year[1]
                                    & all_average$year <= input$senti_year[2]
                                    & all_average$debate_type %in% input$debate_type
                                    & all_average$senti_type == input$senti_options,]
  
  })

  output$sentiplot <- renderPlot({
      
    senti_set <- sentiDataSet()
    
    p6 <- ggplot(senti_set, aes(x=speech_date, col = debate_type, linetype=debate_type))

    p6 + geom_smooth(aes(y=sentiment, linetype = debate_type, 
                     col=debate_type), size=1.5, formula=y ~ log(x)) +
      scale_x_date(date_breaks = "5 year",date_labels = "%Y", name = "Date") + 
      scale_y_continuous(name="Sentiment Score") + 
      scale_linetype_manual(values=debate_line) +
      scale_colour_manual(values=senti_colour) +
      theme(axis.text.x = element_text(angle = 30, hjust = 1), 
          text = element_text(size=14),
          legend.position="bottom", legend.background = element_rect()) +
      guides(col=guide_legend(title=NULL),linetype=guide_legend(title=NULL))
    
  })
  
 output$sentibar<-renderPlot({
    
    senti_bar_data <- sentiDataBar()
    
    senti_bar_data$year <- as.factor(senti_bar_data$year)
    
    p8 <- ggplot(senti_bar_data, aes(x=year, y=sentiment, group = debate_type, fill=debate_type, width=.75))
    
    p8 + geom_bar(stat = "identity", position = position_dodge(width=0.5)) +
      scale_x_discrete(name="Year", breaks=seq(1935,2020, by=5)) +
      #facet_grid(.~year, switch = "x", scales = "free_x", space = "free_x") +
      scale_y_continuous(name="Sentiment Score") + 
      #scale_colour_manual(values=senti_colour) + 
      scale_fill_manual(values=senti_colour) + 
      theme(axis.text.x = element_text(angle = 30, hjust = 1), 
            text = element_text(size=14),
            legend.position="bottom", legend.background = element_rect()) + 
      guides(col=guide_legend(title=NULL), fill=guide_legend(title=NULL))
    
  })
 
   output$sentibox<-renderPlot({
    
    senti_set <- sentiDataSet()
    
    senti_set$year <- as.factor(senti_set$year)
    
    p7 <- ggplot(senti_set, aes(x=year, y = sentiment, width=.75))
    
    p7 + geom_boxplot(aes(col = debate_type)) +
      scale_x_discrete(name="Year", breaks=seq(1935,2020, by=5)) + 
      scale_y_continuous(name="Sentiment Score") + 
      scale_linetype_manual(values=debate_line) +
      scale_colour_manual(values=senti_colour) + 
      theme(axis.text.x = element_text(angle = 30, hjust = 1), 
            text = element_text(size=14),
            legend.position="bottom", legend.background = element_rect()) +
      guides(col=guide_legend(title=NULL))
    
  })
    
},
options = list(height = 600)
)

```


### Government vs Opposition
<a name="gov_dis"></a>
These charts show the scores for all debate and disability debate, seperated between government and opposition, from 2000 <!-- Check date here!-->to the end of 2016.

```{r, echo=FALSE}

shinyApp(

ui <- fluidPage(
  fluidRow(  conditionalPanel(
                           condition = "input.toggle % 3 == 0",
                           h4("Sentiment Line Chart"),
                           plotOutput("senti_gov")
                           ),
                         conditionalPanel(
                           condition = "input.toggle % 3 == 2",
                           h4("Sentiment Box Chart"),
                           plotOutput("senti_gov_box")
                           ),
                         conditionalPanel(
                           condition = "input.toggle % 3 == 1",
                           h4("Sentiment Bar Chart"),
                           plotOutput("senti_gov_bar")
                         )
         
              ),
       fluidRow(
         column(width = 4,

                  checkboxGroupInput(
                         "debate_type", 
                         "Debate Type to Show",
                         choices=c("All Debate", "Disability"),
                         selected =c("All Debate", "Disability")
                       ),
                     
                     checkboxGroupInput(
                       inputId="gov_options",
                       label="Select Government or Opposition:",
                       choices=c(
                         "Government",
                         "Opposition"
                       ),
                       selected=c(
                         "Government",
                         "Opposition"
                       ))
         ),
         column(width = 4,
                    radioButtons(
                       inputId="senti_options",
                       label="Select Sentiment Library:",
                       choices=c(
                         "Sentiword"="sentiword_sentiment",
                         "AFINN"="afinn_sentiment",
                         "Bing"="bing_sentiment",
                         "NRC"="nrc_sentiment",
                         "Hu Liu"="hu_sentiment"
                       ),
                       selected="sentiword_sentiment")
          
                ),
         column(width = 4,
                     
                      sliderInput("senti_year2", "Year", 2000, 2016,
                                   value = c(2000, 2016), sep=""),
                       actionButton("toggle", "Switch Chart Type")
             
                        )
            )

), 

server <- function(input, output, session) {

  sentiDataGov <- reactive({
    
      senti_data <- senti_combined[senti_combined$year >= input$senti_year2[1] 
                                  & senti_combined$year <= input$senti_year2[2]
                                  & senti_combined$senti_type == input$senti_options
                                  & senti_combined$government %in% input$gov_options
                                  & senti_combined$debate_type %in% input$debate_type,]

})

   sentiDataBar <- reactive({
    
      senti_data_bar <- government_average[government_average$year >= input$senti_year2[1]
                                    & government_average$year <= input$senti_year2[2]
                                    & government_average$debate_type %in% input$debate_type
                                    & government_average$government %in% input$gov_options
                                    & government_average$senti_type == input$senti_options,]
  
  })
  
  
 output$senti_gov <- renderPlot({
    
    senti_set <- sentiDataGov()
       
p7 <- ggplot(senti_set, aes(x=speech_date, y=sentiment, 
                            col= interaction(debate_type, government),
                            linetype = interaction(debate_type, government)))

p7 + geom_smooth(size=1.5, formula=y ~ log(x)) +
  scale_x_date(date_breaks = "2 year",date_labels = "%Y", name = "Date") + 
  scale_y_continuous(name="Sentiment Score") + 
  scale_linetype_manual(values=govt_type_line) +
  scale_colour_manual(values=gov_type_colour) +
  theme(axis.text.x = element_text(angle = 30, hjust = 1), 
        text = element_text(size=14),
        legend.position="bottom", legend.background = element_rect()) +
  guides(col=guide_legend(title=NULL),linetype=guide_legend(title=NULL))

    
  })
  
 output$senti_gov_bar<-renderPlot({
    
    senti_bar_data <- sentiDataBar()
    
    senti_bar_data$year <- as.factor(senti_bar_data$year)
    

p8 <- ggplot(senti_bar_data, aes(x=year, y=sentiment,
                                 group = interaction(debate_type, government),
                                 fill = interaction(debate_type, government), width=.75))

p8 + geom_bar(stat = "identity", position = "dodge") +
  scale_x_discrete(name="Year", breaks=seq(2000,2020, by=2)) + 
  scale_y_continuous(name="Sentiment Score") + 
  scale_fill_manual(values=gov_type_colour) + 
  theme(axis.text.x = element_text(angle = 30, hjust = 1), 
        text = element_text(size=14),
        legend.position="bottom", legend.background = element_rect()) + 
  guides(fill=guide_legend(title=NULL))

  })
 
  output$senti_gov_box <- renderPlot({
    
    senti_set <- sentiDataGov()
    
    senti_set$year <- as.factor(senti_set$year)
    
    p7 <- ggplot(senti_set, aes(x=year, y = sentiment, width=.75))
    
    p7 + geom_boxplot(aes(col = debate_type, fill=government)) +
      scale_x_discrete(name="Year", breaks=seq(2000,2020, by=2)) + 
      scale_y_continuous(name="Sentiment Score") + 
      scale_linetype_manual(values=debate_line) +
      scale_colour_manual(values=senti_colour) + 
      theme(axis.text.x = element_text(angle = 30, hjust = 1), 
            text = element_text(size=14),
            legend.position="bottom", legend.background = element_rect()) +
      guides(fill=guide_legend(title=NULL),col=guide_legend(title=NULL))
    
  })
 
 
},
options = list(height = 650)
)

```


### By Party
<a name="party_dis"></a>
These charts show the scores for all debate and disability debate, seperated between different parties, from 2000 <!-- Check date here!-->to the end of 2016. The Conservatives and Liberal Democrats are their own parties, and Labour and Labour Co-op MPs are grouped together as Labour. All other parties are grouped together as Other. <!-- As and when, add SDP to liberal democrats -->

```{r, echo=FALSE}

shinyApp(

  
  ui <- fluidPage(
  fluidRow( 
                      conditionalPanel(
                           condition = "input.toggle % 3 == 0",
                           h4("Sentiment Line Chart"),
                           plotOutput("senti_party")
                           ),
                         conditionalPanel(
                           condition = "input.toggle % 3 == 2",
                           h4("Sentiment Box Chart"),
                           plotOutput("senti_party_box")
                           ),
                         conditionalPanel(
                           condition = "input.toggle % 3 == 1",
                           h4("Sentiment Bar Chart"),
                           plotOutput("senti_party_bar")
                         )
              ),
       fluidRow(
         column(width = 4,
                    checkboxGroupInput(
                         "debate_type", 
                         "Debate Type to Show",
                         choices=c("All Debate", "Disability"),
                         selected = c("All Debate", "Disability")
                       ),
                     
                     checkboxGroupInput(
                       inputId="party_options",
                       label="Select Parties:",
                       choices=c(
                         "Conservative",
                         "Labour",
                         "Liberal Democrat",
                         "Other"
                       ),selected =c(
                         "Conservative",
                         "Labour",
                         "Liberal Democrat")
                       )
         ),
         column(width = 4,
              radioButtons(
                       inputId="senti_options",
                       label="Select Sentiment Library:",
                       choices=c(
                         "Sentiword"="sentiword_sentiment",
                         "AFINN"="afinn_sentiment",
                         "Bing"="bing_sentiment",
                         "NRC"="nrc_sentiment",
                         "Hu Liu"="hu_sentiment"
                       ),
                       selected="sentiword_sentiment")
          
                ),
         column(width = 4,
                     
                      sliderInput("senti_year2", "Year", 2000, 2016,
                                   value = c(2000, 2016), sep=""),
                       actionButton("toggle", "Switch Chart Type")
                        )
            )
), 

server <- function(input, output, session) {
  
  sentiDataParty <- reactive({
            
            senti_data <- senti_combined[senti_combined$year >= input$senti_year2[1] 
                                         & senti_combined$year <= input$senti_year2[2]
                                         & senti_combined$senti_type == input$senti_options
                                         & senti_combined$party_group %in% input$party_options
                                         & senti_combined$debate_type %in% input$debate_type,]
  
})

   sentiDataBar <- reactive({
    
      senti_data_bar <- party_average[party_average$year >= input$senti_year2[1]
                                    & party_average$year <= input$senti_year2[2]
                                    & party_average$debate_type %in% input$debate_type
                                    & party_average$party_group %in% input$party_options
                                    & party_average$senti_type == input$senti_options,]
  
  })
  
 output$senti_party <- renderPlot({
    
       senti_set <- sentiDataParty()

    p7 <- ggplot(senti_set, aes(x=speech_date, y=sentiment, 
                            col= interaction(debate_type, party_group),
                            linetype = interaction(debate_type, party_group)))

p7 + geom_smooth(size=1.5, formula=y ~ log(x)) +
  scale_x_date(date_breaks = "2 year",date_labels = "%Y", name = "Date") + 
  scale_y_continuous(name="Sentiment Score") + 
  scale_linetype_manual(values=party_type_line) +
  scale_colour_manual(values=party_type_colour) +
  theme(axis.text.x = element_text(angle = 30, hjust = 1), 
        text = element_text(size=14),
        legend.position="bottom", legend.background = element_rect()) +
  guides(col=guide_legend(title=NULL),linetype=guide_legend(title=NULL))
    
    
    
  })
 
 output$senti_party_bar<-renderPlot({
    
    senti_bar_data <- sentiDataBar()
    
    senti_bar_data$year <- as.factor(senti_bar_data$year)
    
    p9 <- ggplot(senti_bar_data, aes(x = party_group, y=sentiment,
                                     group = interaction(debate_type, party_group),
                                     fill = interaction(debate_type, party_group), width=.75))

    p9 + geom_bar(stat = "identity", position = "dodge") +
      scale_x_discrete(name="Year", breaks=seq(2000,2020, by=2)) + 
      scale_y_continuous(name="Sentiment Score") + 
      scale_fill_manual(values=party_type_colour) + 
      facet_grid(.~year, switch = "x", scales = "free_x", space = "free_x") +
      theme(axis.text.x = element_text(angle = 30, hjust = 1), 
          text = element_text(size=14),
          legend.position="bottom", legend.background = element_rect(),
          strip.background = element_blank()) +
      guides(fill=guide_legend(title=NULL))

  })
 
  output$senti_party_box<-renderPlot({
    
    senti_set <- sentiDataParty()
    
    senti_set$year <- as.factor(senti_set$year)
    
    p7 <- ggplot(senti_set, aes(x=year, y = sentiment, width=.75))
    
    p7 + geom_boxplot(aes(col = debate_type, fill=party_group)) +
      scale_x_discrete(name="Year", breaks=seq(2000,2020, by=2)) + 
      scale_y_continuous(name="Sentiment Score") + 
      scale_linetype_manual(values=debate_line) +
      scale_colour_manual(values=senti_colour) + 
      scale_fill_manual(values=party_colour) + 
      theme(axis.text.x = element_text(angle = 30, hjust = 1), 
            text = element_text(size=14),
            legend.position="bottom", legend.background = element_rect()) +
      guides(fill=guide_legend(title=NULL),col=guide_legend(title=NULL))
    
  })
  
},
options = list(height = 670)
)

```


## Discussion

This analysis suggests the possible existence of a phenomenon that many disability campaigners have long suspected; that disabled people and disability issues are used by politicians as a tool to advance a political point. This is not restricted to certain parties, but appears across the political spectrum. The distinction is rather between being in government and being in opposition.

In the charts comparing government and opposition sentiments the government is consistently more positive when discussing disability issues, no matter who is in government or which sentiment library is used. When looking at individual parties, you can see the transition quite clearly. Labour's sentiment when debating disability drops quite substantially in 2010 compared to the previous decade, and falls again in 2011, to sit below zero, on average, in 3 out of the 5 sentiment libraries. Likewise, the sentiment of the Conservative party increases substantially in 2010, along with that of the Liberal Democrats, their coalition partners from 2010 to 2015.

The average sentiments in all debate, unsurprising, follow a similar pattern. A party in government is going to spend much more time showing off what is has achieved or plans to achieve, while an opposition party, by its nature, opposes. So a government uses more positive language, and an opposition party more negative language. <!-- I really need the frequency analysis by party--> 

However, the debate about disability is more negative than average, and undergoes a greater switch from positive to negative when a party leaves government, and vice versa when a party enters government. In all the libraries except `AFINN`, disability debate from the Labour party becomes more negative, and more quickly, than debate on all other topics post their 2010 election defeat. Likewise, the Conservative party, who were consistently more negative on disability than their average topic in 3 out of 5 libraries throughout the 2000s, see a substantial increase in the positivity of their disability debate, an increase that is much greater than the increase in their overall debate.

This suggests that disability is a popular topic for opposition parties to criticise the government on. Parties of all stripes have made promises in opposition or in election manifestos to increase the employment of disabled people, or end discrimination, or make public spaces more accessible, and these are all admirable aims. But when those parties find themselves in government, they often fail to deliver on those pledges. So any opposition MP looking for an awkward question to ask a government minister, or wanting to find a policy failure

A current example is the Conservative government's pledge on page 19 of [their 2015 election manifesto](https://s3-eu-west-1.amazonaws.com/manifesto2015/ConservativeManifesto2015.pdf) to cut the disability employment gap in half, presumably by 2020: 

> Last year alone, 140,000 disabled people found work. But the jobless rate for this group remains too high and, as part of our objective to achieve full employment, we will aim to halve the disability employment gap: we will transform policy, practice and public attitudes, so that hundreds of thousands more disabled people who can and want to be in work find employment.

The All Party Parliamentary Group on Disability, in a report at the end of last year, pointed out that at the [current rate of change cutting the disability employment gap in half will take until 2065](https://www.cass.city.ac.uk/__data/assets/pdf_file/0010/339607/All-Party-Parliamentary-Group-on-Disability-Ahead-of-the-Arc-Report.pdf). It is just one of many instances of a party with an admirable election pledge failing to deliver it once in office.


# Methodology

<a name="senti_exp"></a>

There are five <!-- There are almost certainly more --> options for sentiment analysis:

1. The [Sentiwords](http://sentiwordnet.isti.cnr.it/) dataset, created by Stefano Baccianella, Andrea Esuli, and Fabrizio Sebastiani. Sentiwords identifies words as either positive or negative. The Sentiwords library was accessed through the library was accessed through the [`lexicon`](https://cran.r-project.org/package=lexicon) package. [@baccianella2010]

2. The [AFINN](http://www2.imm.dtu.dk/pubdb/views/publication_details.php?id=6010) library by Finn Årup Nielsen, labelled 'AFINN'. AFINN assigns a score from -5 (most negative) to +5 (most positive) to each word. The AFINN library was accessed through the [`syuzhet`](https://cran.r-project.org/package=syuzhet) package. [@nielsen2011]

3. The [Opinion Mining, Sentiment Analysis](https://www.cs.uic.edu/~liub/FBS/sentiment-analysis.html), and Opinion Spam Detection</a> dataset by Bing Liu, Minqing Hu and Junsheng Cheng, labelled 'Bing'. Bing identifies words as either positive or negative. The Bing library was access through the [`syuzhet`](https://cran.r-project.org/package=syuzhet) package. [@liu2005]

4. The [NRC Word-Emotion Association Lexicon](http://saifmohammad.com/WebPages/lexicons.html), library by Saif M. Mohammad, labelled 'NRC'. NRC identifies words as either positive or negative. The NRC library was access through the [`syuzhet`](https://cran.r-project.org/package=syuzhet) package. [@mohammad2013]

5. The Hu & Liu dataset, by Minqing Hu and Bing Liu, labelled 'Hu Liu'. Hu & Liu identifies words as either positive or negative. The Hu & Liu library was accessed through the [`sentimentr`](https://cran.r-project.org/package=sentimentr) package. [@hu2004] 

### Dataset
The [ParlParse](http://parser.theyworkforyou.com/) service, operated by [They Work For You](https://www.theyworkforyou.com/), records everything said in parliament from 1936 to the present day. The full dataset includes 5,440,317 different speeches, of which [438,180][FIX NUMBER!] are included in disability dataset, as they contain one or more of the disability phrases searched for. There are a further [however many] entries in the all debate dataset, representing a random sample of 5% of all Hansard entries.

The ParlParse service does not record the party affiliation of MPs, or an ID number that can be matched to data from the UK parliament, and so identification of party affiliation was done primarily by hand, comparing the reported names in the datasets to official registers of current and former MPs. For older MPs I often had to search online for other archival records in order to identify them. MPs who have been members of multiple parties are recorded as having been a member of the party to which they are most recently affiliated [should see about fixing this]. Due to the sheer volume of data and the inconsistent naming conventions in older Hansard records, party affiliations are only reliably identified from 1997 <!--Update as needed --> onwards.


## Phrases Used

<a name="word_list"></a>

* Disability Other
    + 'disability'

* Disabled People
    + 'disabled person'
    + 'disabled people'

* Disabled Children
    + 'disabled child'

* People with Disability
    + 'person with a disability'
    + 'people with a disability'
    + 'people with disabilities'
    + 'person with disabilities'

* Any with Disability
    + 'with a disability'
    + 'with disabilities'

* Disabled Men
    + 'disabled men'

* Disabled Men
    + 'disabled women'

* Children with Disability
    + 'child with a disability'
    + 'children with a disability'
    + 'children with disabilities'
    + 'child with disabilities'

* Independent Living
    + 'independent living'

* Wheelchair
    + 'wheelchair'

* Paralympic
    + 'paralympic'

* Spastic
    + 'spastic'

* Sub-Normal
    + 'sub-normal'

* Amputee
    + 'amputee'

* Retard
    + 'retard'



# Notes

Source code is available on [Github](https://github.com/EvanOdell/hansard-sentiment). For assistance, questions or comments please contact Evan Odell via [email](mailto:evan.odell@disabilityrightsuk.org) or [Twitter](https://twitter.com/evanodell), or raise an issue on Github.

This app is licensed under an [MIT License](https://github.com/EvanOdell/hansard-sentiment/blob/master/LICENSE).

The data used in this app was retrieved from the [ParlParse](https://www.theyworkforyou.com/pwdata/scrapedxml/) service operated by [MySociety](https://www.mysociety.org/). <!-- link to dataset -->

This app was constructed using [`shiny`](http://shiny.rstudio.com/). Plots are produced with [`ggplot2`](https://cran.r-project.org/package=ggplot2) and [`scales`](https://cran.r-project.org/package=scales). Sentiment analysis was conducted using the [`sentimentr`](https://cran.r-project.org/package=sentimentr), [`syuzhet`](https://cran.r-project.org/package=syuzhet) and [`lexicon`](https://cran.r-project.org/package=lexicon) packages.

# References